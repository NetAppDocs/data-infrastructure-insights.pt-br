---
sidebar: sidebar 
permalink: task_config_telegraf_haproxy.html 
keywords: telegraf, installation, install, haproxy 
summary: Configuração do coletor de dados HAProxy 
---
= Coletor de dados HAProxy
:hardbreaks:
:allow-uri-read: 


[role="lead"]
O Data Infrastructure Insights usa esse coletor de dados para coletar métricas do HAProxy.



== Instalação

. Em *Observabilidade > Coletores*, clique em *+Coletor de Dados*.  Escolha HAProxy.
+
Selecione o sistema operacional ou plataforma na qual o agente Telegraf está instalado.

. Se você ainda não instalou um Agente para coleta ou deseja instalar um Agente para um Sistema Operacional ou Plataforma diferente, clique em _Mostrar Instruções_ para expandir olink:task_config_telegraf_agent.html["Instalação do agente"] instruções.
. Selecione a Chave de Acesso do Agente para uso com este coletor de dados.  Você pode adicionar uma nova Chave de Acesso do Agente clicando no botão *+ Chave de Acesso do Agente*.  Prática recomendada: use uma chave de acesso de agente diferente somente quando quiser agrupar coletores de dados, por exemplo, por sistema operacional/plataforma.
. Siga as etapas de configuração para configurar o coletor de dados.  As instruções variam dependendo do tipo de sistema operacional ou plataforma que você está usando para coletar dados.


image:HAProxyDCConfigLinux.png["Configuração do HAProxy"]



== Configurar

O plugin do Telegraf para HAProxy depende da ativação do HAProxy Stats.  Esta é uma configuração incorporada ao HAProxy, mas não vem habilitada de fábrica.  Quando ativado, o HAProxy exporá um ponto de extremidade HTML que pode ser visualizado no seu navegador ou extraído para extração do status de todas as configurações do HAProxy.



=== Compatibilidade:

A configuração foi desenvolvida na versão 1.9.4 do HAProxy.



=== Configuração:

Para habilitar estatísticas, edite seu arquivo de configuração do haproxy e adicione as seguintes linhas após a seção 'defaults', usando seu próprio usuário/senha e/ou URL do haproxy:

[listing]
----
stats enable
stats auth myuser:mypassword
stats uri  /haproxy?stats
----
A seguir está um exemplo simplificado de arquivo de configuração com estatísticas habilitadas:

[listing]
----
global
  daemon
  maxconn 256

defaults
  mode http
  stats enable
  stats uri /haproxy?stats
  stats auth myuser:mypassword
  timeout connect 5000ms
  timeout client 50000ms
  timeout server 50000ms

frontend http-in
  bind *:80
  default_backend servers

frontend http-in9080
  bind *:9080
  default_backend servers_2

backend servers
  server server1 10.128.0.55:8080 check ssl verify none
  server server2 10.128.0.56:8080 check ssl verify none

backend servers_2
  server server3 10.128.0.57:8080 check ssl verify none
  server server4 10.128.0.58:8080 check ssl verify none
----
Para obter instruções completas e atualizadas, consulte olink:https://cbonte.github.io/haproxy-dconv/1.8/configuration.html#4-stats%20enable["Documentação do HAProxy"] .



== Objetos e Contadores

Os seguintes objetos e seus contadores são coletados:

[cols="<.<,<.<,<.<,<.<"]
|===
| Objeto: | Identificadores: | Atributos: | Pontos de dados: 


| Interface HAProxy | Proxy de endereço de namespace | IP do nó Nome do nó ID do proxy Modo ID do processo Limite de taxa de sessões ID do servidor Limite de sessões Status | Bytes de entrada Bytes de saída Acertos no cache Pesquisas no cache Compressão Bytes ignorados Compressão Bytes de entrada Compressão Bytes de saída Compressão Respostas Taxa de conexão Taxa de conexão Máximo de conexões Total de solicitações negadas pela regra de conexão Solicitações negadas por problemas de segurança Respostas negadas por problemas de segurança Solicitações negadas pela regra de sessão Erros de solicitações Respostas 1xx Respostas 2xx Respostas 3xx Respostas 4xx Respostas 5xx Respostas Outras solicitações Taxa de sessões interceptadas Taxa de sessões Taxa de solicitações Máximo de solicitações Taxa de solicitações Máximo de solicitações Total de sessões Sessões Máximo de sessões Total de solicitações Reescritas 


| Servidor HAProxy | Servidor proxy de endereço de namespace | IP do nó Nome do nó Verificar tempo para terminar Verificar configuração de queda Verificar valor de integridade Verificar configuração de ascensão Verificar status ID do proxy Última hora de alteração Última hora da sessão Modo ID do processo ID do servidor Status Peso | Servidores ativos Servidores de backup Bytes de entrada Bytes de saída Verificações de baixa Verificações Falhas de cliente Aborta conexões Tempo médio de conexão Tempo de inatividade Total de respostas negadas Erros de conexão Erros de resposta Respostas 1xx Respostas 2xx Respostas 3xx Respostas 4xx Respostas 5xx Respostas Outro servidor selecionado Fila total Fila atual Tempo médio máximo da fila Sessões por segundo Sessões por segundo Tempo máximo de resposta de reutilização de conexão Média de sessões Sessões Máximas de transferências do servidor Aborta sessões Total de sessões Tempo total Média de solicitações Reenvios Solicitações Tentativas Solicitações Reescritas 


| Backend HAProxy | Proxy de endereço de namespace | IP do nó Nome do nó ID do proxy Última hora de alteração Última hora da sessão Modo ID do processo ID do servidor Limite de sessões Status Peso | Servidores ativos Servidores de backup Bytes de entrada Bytes de saída Acertos no cache Pesquisas no cache Verificações de baixa do cliente Abortos de compactação Bytes ignorados Bytes de compactação em compressão Bytes de saída Respostas de compactação Conexões Tempo médio de inatividade Total de solicitações negadas por problemas de segurança Respostas negadas por problemas de segurança Erros de conexão Erros de resposta Respostas 1xx Respostas 2xx Respostas 3xx Respostas 4xx Respostas 5xx Respostas Outro servidor selecionado Fila total Fila atual Tempo médio máximo da fila Sessões por segundo Sessões por segundo Máximo de solicitações Tempo total de resposta de reutilização de conexão Média de sessões Sessões Máximo de abortos de transferência do servidor Sessões Total de sessões Tempo total de solicitações Média de solicitações Reenvios Solicitações Tentativas Solicitações Reescritas 
|===


== Solução de problemas

Informações adicionais podem ser encontradas emlink:concept_requesting_support.html["Apoiar"] página.
